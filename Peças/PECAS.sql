-- MySQL Script generated by MySQL Workbench
-- Sat Nov 29 13:15:40 2025
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`CORREDOR`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`CORREDOR` (
  `ID_CORREDOR` INT NOT NULL AUTO_INCREMENT,
  `NOME_CORREDOR` VARCHAR(50) NOT NULL,
  PRIMARY KEY (`ID_CORREDOR`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`RECECPTACULO`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`RECECPTACULO` (
  `ID_RECECPTACULO` INT NOT NULL AUTO_INCREMENT,
  `NOME_RECEPTACULO` VARCHAR(20) NOT NULL,
  `CORREDOR_ID_CORREDOR` INT NOT NULL,
  PRIMARY KEY (`ID_RECECPTACULO`),
  INDEX `fk_RECECPTACULO_CORREDOR_idx` (`CORREDOR_ID_CORREDOR` ASC),
  CONSTRAINT `fk_RECECPTACULO_CORREDOR`
    FOREIGN KEY (`CORREDOR_ID_CORREDOR`)
    REFERENCES `mydb`.`CORREDOR` (`ID_CORREDOR`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`PECA`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`PECA` (
  `ID_PECA` INT NOT NULL AUTO_INCREMENT,
  `DESCRICAO_PECA` VARCHAR(100) NOT NULL,
  PRIMARY KEY (`ID_PECA`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ESTOQUE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ESTOQUE` (
  `PECA_ID_PECA` INT NOT NULL,
  `RECECPTACULO_ID_RECECPTACULO` INT NOT NULL,
  PRIMARY KEY (`PECA_ID_PECA`, `RECECPTACULO_ID_RECECPTACULO`),
  INDEX `fk_PECA_has_RECECPTACULO_RECECPTACULO1_idx` (`RECECPTACULO_ID_RECECPTACULO` ASC),
  INDEX `fk_PECA_has_RECECPTACULO_PECA1_idx` (`PECA_ID_PECA` ASC),
  CONSTRAINT `fk_PECA_has_RECECPTACULO_PECA1`
    FOREIGN KEY (`PECA_ID_PECA`)
    REFERENCES `mydb`.`PECA` (`ID_PECA`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_PECA_has_RECECPTACULO_RECECPTACULO1`
    FOREIGN KEY (`RECECPTACULO_ID_RECECPTACULO`)
    REFERENCES `mydb`.`RECECPTACULO` (`ID_RECECPTACULO`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

INSERT INTO CORREDOR (NOME_CORREDOR)
VALUES
('Corredor A'),
('Corredor B'),
('Corredor C');

INSERT INTO RECECPTACULO (NOME_RECEPTACULO, CORREDOR_ID_CORREDOR)
VALUES
('R-01', 1),
('R-02', 1),
('R-10', 2),
('R-20', 3);

INSERT INTO PECA (DESCRICAO_PECA)
VALUES
('Parafuso 10mm'),
('Porca 8mm'),
('Arruela Aço Forte'),
('Engrenagem Pequena');

INSERT INTO ESTOQUE (PECA_ID_PECA, RECECPTACULO_ID_RECECPTACULO)
VALUES
(1, 1),  -- Parafuso 10mm no receptáculo R-01
(1, 2),  -- Parafuso 10mm no R-02
(2, 1),  -- Porca 8mm no R-01
(3, 3),  -- Arruela no R-10
(4, 4);  -- Engrenagem no R-20


SELECT * FROM CORREDOR;

SELECT r.ID_RECECPTACULO, r.NOME_RECEPTACULO, c.NOME_CORREDOR
FROM RECECPTACULO r
JOIN CORREDOR c ON r.CORREDOR_ID_CORREDOR = c.ID_CORREDOR;

SELECT * FROM PECA;

SELECT p.ID_PECA,
       p.DESCRICAO_PECA,
       re.NOME_RECEPTACULO,
       c.NOME_CORREDOR
FROM ESTOQUE e
JOIN PECA p ON e.PECA_ID_PECA = p.ID_PECA
JOIN RECECPTACULO re ON e.RECECPTACULO_ID_RECECPTACULO = re.ID_RECECPTACULO
JOIN CORREDOR c ON re.CORREDOR_ID_CORREDOR = c.ID_CORREDOR
ORDER BY p.ID_PECA;

SELECT p.DESCRICAO_PECA, re.NOME_RECEPTACULO
FROM ESTOQUE e
JOIN PECA p ON e.PECA_ID_PECA = p.ID_PECA
JOIN RECECPTACULO re ON e.RECECPTACULO_ID_RECECPTACULO = re.ID_RECECPTACULO
WHERE re.CORREDOR_ID_CORREDOR = 1;

SELECT p.DESCRICAO_PECA, re.NOME_RECEPTACULO, c.NOME_CORREDOR
FROM ESTOQUE e
JOIN PECA p ON e.PECA_ID_PECA = p.ID_PECA
JOIN RECECPTACULO re ON e.RECECPTACULO_ID_RECECPTACULO = re.ID_RECECPTACULO
JOIN CORREDOR c ON re.CORREDOR_ID_CORREDOR = c.ID_CORREDOR
WHERE p.ID_PECA = 1;

SELECT c.NOME_CORREDOR, COUNT(*) AS QtdePecas
FROM ESTOQUE e
JOIN RECECPTACULO re ON e.RECECPTACULO_ID_RECECPTACULO = re.ID_RECECPTACULO
JOIN CORREDOR c ON re.CORREDOR_ID_CORREDOR = c.ID_CORREDOR
GROUP BY c.NOME_CORREDOR;






